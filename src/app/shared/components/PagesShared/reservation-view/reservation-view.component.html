<app-calendar
  [idTypeCitation]="idTypeCitation"
  [todos]="todos"
  (dateChange)="onDateChange($event)"
  (blocksLoaded)="onBlocksLoaded($event)">
</app-calendar>

<div class="horarios-container" *ngIf="blocks.length > 0">
  <div class="header-section">
    <h2 class="horarios-title">Horarios disponibles</h2>
    <button class="toggle-view-btn" (click)="toggleView()">
      <span>{{ vistaColumnas ? 'Vista vertical' : 'Vista en columnas' }}</span>
      <span>{{ vistaColumnas ? 'ðŸ“‹' : 'ðŸ“Š' }}</span>
    </button>
  </div>

  <div class="horarios-grid" [class.columnas]="vistaColumnas">
    <!-- MaÃ±ana -->
    <div class="horarios-section" *ngIf="horariosManana.length > 0">
      <h3 class="section-title">Horarios de MaÃ±ana</h3>
      <div class="horarios-scroll">
        <div *ngFor="let h of horariosManana"
             class="horario-item"
             [class.horario-disponible]="h.estaDisponible"
             [class.horario-ocupado]="!h.estaDisponible"
             (click)="seleccionarHorario(h)">
          <div class="horario-info">
            <div class="hora-label">Hora:</div>
            <div class="hora-time">{{ formatearHora(h.hora) }}</div>
          </div>
          <div class="medico-info">
            <div class="especialidad">{{ especialidad }}</div>
            <div class="doctor-name">{{ nombreDoctor }}</div>
          </div>
          <div class="badge" *ngIf="h.bookedCitationId">Booked</div>
          <div class="badge" *ngIf="!h.bookedCitationId && !h.estaDisponible">Hold</div>
        </div>
      </div>
    </div>

    <!-- Tarde -->
    <div class="horarios-section" *ngIf="horariosTarde.length > 0">
      <h3 class="section-title">Horarios de Tarde</h3>
      <div class="horarios-scroll">
        <div *ngFor="let h of horariosTarde"
             class="horario-item"
             [class.horario-disponible]="h.estaDisponible"
             [class.horario-ocupado]="!h.estaDisponible"
             (click)="seleccionarHorario(h)">
          <div class="horario-info">
            <div class="hora-label">Hora:</div>
            <div class="hora-time">{{ formatearHora(h.hora) }}</div>
          </div>
          <div class="medico-info">
            <div class="especialidad">{{ especialidad }}</div>
            <div class="doctor-name">{{ nombreDoctor }}</div>
          </div>
          <div class="badge" *ngIf="h.bookedCitationId">Booked</div>
          <div class="badge" *ngIf="!h.bookedCitationId && !h.estaDisponible">Hold</div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="no-horarios" *ngIf="blocks.length === 0">
  <p>No hay horarios disponibles para la fecha seleccionada.</p>
</div>