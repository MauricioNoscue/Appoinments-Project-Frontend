<h1>Personas relacionadas</h1>

<div class="cards-grid">
  <mat-card
    class="person-card"
    *ngFor="let p of people()"
    (click)="select(p)"
    [class.selected]="selectedId() === p.id"
    tabindex="0"
    [attr.aria-pressed]="selectedId() === p.id"
    [attr.aria-label]="'Seleccionar a ' + p.fullName">

    <div class="top">
      <!-- color dinámico -->
      <div class="avatar" [style.background]="p.color || '#4f46e5'">
        {{ initials(p.fullName) }}
      </div>

      <div class="text-block">
        <div class="name">{{ p.fullName }}</div>
        <mat-chip class="relation-chip" selected>{{ p.relation }}</mat-chip>
      </div>

      <button
        mat-icon-button
        class="menu-btn"
        (click)="$event.stopPropagation()"
        [matMenuTriggerFor]="menu"
        aria-label="Más opciones">
        <mat-icon>more_vert</mat-icon>
      </button>
    </div>

    <mat-menu #menu="matMenu" xPosition="before">
      <button mat-menu-item (click)="view(p)">
        <mat-icon>visibility</mat-icon>
        <span>Ver</span>
      </button>

      <button mat-menu-item (click)="edit(p)">
        <mat-icon>edit</mat-icon>
        <span>Editar</span>
      </button>

      <!-- AHORA: confirmar con Swal -->
      <button mat-menu-item (click)="confirmRemove(p)">
        <mat-icon>delete</mat-icon>
        <span>Eliminar</span>
      </button>
    </mat-menu>
  </mat-card>

  <button class="add-card" (click)="addPerson()" aria-label="Agregar persona">
    <div class="add-dashed">
      <div class="plus">+</div>
      <div class="add-text">Agrega Persona</div>
    </div>
  </button>
</div>
